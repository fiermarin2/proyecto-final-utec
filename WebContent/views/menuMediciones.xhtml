<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition template="/layout/layout.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:jsf="http://xmlns.jcp.org/jsf">
	
	<ui:define name="content">
		<div class="wrapper wrapper-content animated fadeInRight">
		    <div class="row">
		        <div class="col-lg-12">
		            <div class="ibox float-e-margins">
		            	<div class="ibox-title">
		                    <h5>Lista de mediciones</h5>
		                </div>
<<<<<<< HEAD
		                <div class="ibox-content">	 
		                
						    <form jsf:id="departamentos" enctype="multipart/form-data">
=======
		                <div class="ibox-content">	                    
						    <form jsf:id="departamentos">
>>>>>>> parent of f7149d6 (exportar excel)
			                    <div class="table-responsive">
			                    	<p:dataTable var="medicion" widgetVar="dtMediciones" value="#{gestionMediciones.listar()}" rowKey="#{medicion.id}" reflow="true" styleClass="products-table">
				                    	<f:facet name="header">
							                <div class="input-group">
							                    <p:inputText id="globalFilter" onkeyup="PF('dtMediciones').filter()" class="form-control" placeholder="Busqueda global"/>
							                    
							                    <span class="filter-container ui-input-icon-left" > 
							                       	<h:link outcome ="frmMediciones.xhtml" class="btn btn-success">
										    			<f:param name="modalidad" value="insert" /><i class="pi pi-plus"></i> Nuevo
													</h:link>
							                    </span>
							                </div>
<<<<<<< HEAD
							                <br/>
							               	<div class="input-group">
							               		<h:outputLabel value="Importar medición " />
										        <h:inputFile value="#{gestionMediciones.file}" aria-label="File browser example">
											        <p:ajax listener="#{gestionMediciones.importar()}" />
											    </h:inputFile>
							               </div>
=======
>>>>>>> parent of f7149d6 (exportar excel)
							            </f:facet>
			                    		<p:column style="width:2rem">
							                <p:rowToggler/>
							            </p:column>
			                    		<p:column headerText="Formulario" filterBy="#{medicion.formulario.nombre}">
							                <h:outputText value="#{medicion.formulario.nombre}"/>
							            </p:column>
							            <p:column headerText="Fecha" filterBy="#{medicion.fecha_Hora}">
							                <h:outputText value="#{medicion.fecha_Hora}"/>
							            </p:column>
							            <p:column headerText="Departamento" filterBy="#{medicion.departamento.nombre}">
							                <h:outputText value="#{medicion.departamento.nombre}"/>
							            </p:column>
							            <p:column headerText="Estacion" filterBy="#{medicion.estacion.nombre}">
							                <h:outputText value="#{medicion.estacion.nombre}"/>
							            </p:column>
							            <p:column headerText="Acciones">
											<p:link outcome="frmMediciones.xhtml">
									      		<f:param name="id" value="${medicion.id}"/>
								    			<f:param name="modalidad" value="update" />
								                <i class="btn btn-xs btn-default pi pi-pencil"></i>
									        </p:link>
									        <p:spacer width="2" />
									        <p:commandLink action="#{gestionMediciones.eliminarMedicion}">
									      		<f:param name="id" value="${medicion.id}"/>
									      		<i class="btn btn-xs btn-danger pi pi-trash"></i>
									        <p:confirm header="Confirmacion" message="¿Quiere eliminar este registro?" icon="pi pi-info-circle"/>
									        </p:commandLink>
								         	<p:confirmDialog global="true" showEffect="fade" hideEffect="fade" responsive="true" width="350">
									            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no ui-button-flat"/>
									            <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" />
								        	</p:confirmDialog>
										</p:column>
							            <p:rowExpansion>
							            	<div class="card">
							            		<p:commandButton value="XLS" styleClass="mr-2 mb-2">
								                    <p:dataExporter type="xls" target="tbl2" fileName="mediciones" exporter="#{dataExporterView.prueba()}"/>
								                </p:commandButton>
								            	<p:dataTable var="valor" id="tbl2" value="#{medicion.valor.entrySet().toArray()}">
								            		<p:column headerText="Formulario" visible="false">
								            			<h:outputText value="#{medicion.formulario.nombre}"/>
								            		</p:column>
								            		<p:column headerText="Fecha" visible="false">
								            			<h:outputText value="#{medicion.fecha_Hora}"/>
								            		</p:column>
								            		<p:column headerText="Estacion" visible="false">
								            			<h:outputText value="#{medicion.estacion.nombre}"/>
								            		</p:column>
								            		<p:column headerText="Casilla">
										                <h:outputText value="#{valor.key}"/>
										            </p:column>
										            <p:column headerText="Medición">
										                <h:outputText value="#{valor.value}"/>
										            </p:column>
								            	</p:dataTable>
        									</div>
							            </p:rowExpansion>
			                    	</p:dataTable>
								</div>
							</form>
		            	</div>
		        	</div>
		    	</div>
			</div>
		</div>
    </ui:define>
</ui:composition>